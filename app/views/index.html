{% extends "layout.html" %}

{% block content %}
<div class="row">
    <div class="col-xs-12">
        {% if config_sets_ctx.IsRemote %}
        Revision: {{ config_sets_ctx.Repo.Revision }}<br>
        {% endif %}
        <a href="/update_proc_config_sets">Update ProcConfigSets</a>
    </div>
</div>

<div class="row">
    <div class="col-xs-3">
        <h1>Proc</h1>
        <ul>
        {% for config_set in config_sets_ctx.SortedConfigSets() %}
            <li>{{ config_set.Name }}</li>
            <ul>
                {% for c in config_set.SortedConfigs() %}
                <li>{{ c.version }} <strong><a href="/queue/{{ c.name | urlencode}}/{{ c.version | urlencode}}">to_queue</a></strong> <a href="/build/{{ c.name | urlencode}}/{{ c.version | urlencode}}">exec</a></li>
                {% endfor %}
            </ul>
        {% endfor %}
        </ul>
    </div>

    <div class="col-xs-3">
        <h1>Queue</h1>
        <ul>
            {% for q in queued_tasks %}

            <li>Waiting: {{ q.proc.name }} {{ q.proc.version }}</li>

            {% endfor %}
        </ul>
    </div>

    <div class="col-xs-6">
        <h1>Tasks</h1>
        <ul>
            {% for task in tasks %}

            {% if task.Status == 0 %}
            {# running #}

            <li><a href="/{% if task.IsActive %}live_status{% else %}status{% endif %}/{{task.Id}}">{{task.LogName}}</a> <span class="label label-primary">Running</span></li>

            {% elif task.Status == 1 %}
            {# succeeded #}
            <li><a href="/{% if task.IsActive %}live_status{% else %}status{% endif %}/{{task.Id}}">{{task.LogName}}</a> <span class="label label-success">Succeeded</span></li>

            {% elif task.Status == 2 %}
            {# failed #}
            <li><a href="/{% if task.IsActive %}live_status{% else %}status{% endif %}/{{task.Id}}">{{task.LogName}}</a> <span class="label label-danger">Failed</span></li>

            {% elif task.Status == 3 %}
            {# aborted #}
            <li><a href="/{% if task.IsActive %}live_status{% else %}status{% endif %}/{{task.Id}}">{{task.LogName}}</a> <span class="label label-danger">Aborted</span></li>

            {% endif %}

            {% endfor %}
        </ul>
    </div>
</div>

{% endblock %}
